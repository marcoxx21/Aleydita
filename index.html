<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Aleydita üíô</title>
<style>
  :root {
    --color-fondo: #f0f7fa;
    --color-primario: #7aaedb;
    --color-secundario: #d7e6f8;
    --color-texto: #305973;
    --color-activo: #aacffb;
    --color-boton: #5291e9;
    --color-boton-hover: #3b6cb7;
    --color-secundario2: #cbc1f7;
    --color-bg1: #f0f7fa;
    --color-bg2: #d7e6f8;
    --color-bg3: #cbc1f7;
  }

  * {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 40px 20px;
    font-family: 'Poppins', sans-serif;
    background: var(--color-fondo);
    color: var(--color-texto);
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    overflow-x: hidden;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    transition: background 2s ease;
  }

  h1 {
    font-weight: 800;
    font-size: 2.8rem;
    color: var(--color-primario);
    letter-spacing: 0.12em;
    margin-bottom: 10px;
    opacity: 0;
    transform: translateY(-15px);
    animation: fadeSlideDown 1s forwards;
    animation-delay: 0.2s;
  }

  .mensaje {
    font-weight: 500;
    font-size: 1.3rem;
    font-style: italic;
    color: var(--color-texto);
    max-width: 650px;
    margin-bottom: 40px;
    opacity: 0;
    transform: translateY(-10px);
    animation: fadeSlideDown 1s forwards;
    animation-delay: 0.5s;
    line-height: 1.5;
    text-align: center;
  }

  @keyframes fadeSlideDown {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  audio {
    width: 100%;
    max-width: 480px;
    border-radius: 20px;
    box-shadow: 0 8px 25px rgba(122, 174, 219, 0.3);
    margin-bottom: 35px;
    outline-offset: 4px;
    outline: 1px solid var(--color-primario);
    transition: box-shadow 0.3s ease;
  }

  audio:hover,
  audio:focus {
    box-shadow: 0 12px 35px rgba(122, 174, 219, 0.5);
  }

  #lyrics-container {
    max-width: 600px;
    width: 100%;
    background: var(--color-secundario2);
    border-radius: 30px;
    padding: 25px 35px;
    box-shadow: 0 8px 28px rgba(170, 207, 251, 0.3);
    max-height: 320px;
    overflow-y: auto;
    scroll-behavior: smooth;
    margin-bottom: 50px;
    font-weight: 500;
    font-size: 1.2rem;
    color: var(--color-texto);
    position: relative;
    transition: background 2s ease;
  }

  #lyrics {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  #lyrics li {
    padding: 10px 15px;
    margin-bottom: 10px;
    border-radius: 20px;
    color: var(--color-texto);
    cursor: default;
    user-select: none;
    opacity: 0.7;
    transition:
      background-color 0.4s ease,
      color 0.4s ease,
      transform 0.3s ease,
      opacity 0.5s ease,
      box-shadow 0.4s ease;
    transform: translateX(-10px);
    animation: fadeSlideIn 0.4s forwards;
  }

  #lyrics li.active {
    background: var(--color-activo);
    color: var(--color-texto);
    font-weight: 700;
    opacity: 1;
    transform: scale(1.04) translateX(0);
    box-shadow: 0 6px 16px rgba(122, 174, 219, 0.6);
    animation: pulseGlow 1.5s infinite alternate, activeLineShine 1.5s ease forwards;
  }

  @keyframes fadeSlideIn {
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes pulseGlow {
    from {
      box-shadow: 0 6px 16px rgba(122, 174, 219, 0.4);
    }
    to {
      box-shadow: 0 10px 24px rgba(122, 174, 219, 0.8);
    }
  }
  @keyframes activeLineShine {
    0% { filter: brightness(1); }
    50% { filter: brightness(1.15); }
    100% { filter: brightness(1); }
  }

  /* Bot√≥n elegante con pulso suave */
  button.btn-carta {
    background: var(--color-boton);
    border: none;
    padding: 14px 34px;
    border-radius: 40px;
    font-size: 1.15rem;
    color: white;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 8px 25px rgba(82, 145, 233, 0.4);
    transition: background-color 0.3s ease, box-shadow 0.3s ease, transform 0.3s ease;
    user-select: none;
    outline-offset: 3px;
    outline: 2px solid transparent;
    filter: drop-shadow(0 0 5px var(--color-boton));
    margin-bottom: 30px;
    animation: pulseButton 3s infinite;
    display: block;
    margin-left: auto;
    margin-right: auto;
  }

  button.btn-carta:hover,
  button.btn-carta:focus {
    background: var(--color-boton-hover);
    box-shadow: 0 10px 28px rgba(59, 108, 183, 0.8);
    outline: 2px solid var(--color-boton-hover);
    outline-offset: 6px;
    transform: translateY(-3px) scale(1.02);
    animation-play-state: paused;
  }

  @keyframes pulseButton {
    0%, 100% { filter: drop-shadow(0 0 5px var(--color-boton)); }
    50% { filter: drop-shadow(0 0 15px var(--color-boton)); }
  }

  #carta {
    max-width: 720px;
    background: var(--color-secundario);
    padding: 32px 40px;
    border-radius: 32px;
    box-shadow: 0 10px 40px rgba(170, 207, 251, 0.25);
    font-family: 'Georgia', serif;
    font-size: 1.15rem;
    color: var(--color-texto);
    line-height: 1.65;
    text-align: justify;
    opacity: 0;
    max-height: 0;
    overflow: hidden;
    transition: opacity 0.6s ease, max-height 0.6s ease, padding 0.6s ease;
    margin: 0 auto 50px auto;
    white-space: pre-wrap;
  }

  #carta.visible {
    opacity: 1;
    max-height: 900px;
    padding: 32px 40px;
  }

  /* Animaci√≥n typewriter para texto carta */
  @keyframes typewriter {
    from { width: 0 }
    to { width: 100% }
  }

  /* Corazones animados minimalistas */
  .corazones {
    position: fixed;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: hidden;
    z-index: -1;
    top: 0;
    left: 0;
  }

  .corazon {
    position: absolute;
    width: 22px;
    height: 22px;
    background: var(--color-boton);
    border-radius: 50% 50% 0 0;
    transform: rotate(45deg);
    margin-left: -11px;
    box-shadow: 0 2px 8px rgba(82, 145, 233, 0.7);
    animation: corazonFlotar 9s ease-in infinite;
    filter: drop-shadow(0 0 3px var(--color-boton));
  }
  .corazon::before,
  .corazon::after {
    content: \"\";
    position: absolute;
    width: 22px;
    height: 22px;
    background: var(--color-boton);
    border-radius: 50%;
    filter: drop-shadow(0 0 3px var(--color-boton));
  }
  .corazon::before {
    top: -11px;
    left: 0;
  }
  .corazon::after {
    top: 0;
    left: -11px;
  }

  .corazon:nth-child(1) {
    left: 15%;
    animation-delay: 0.2s;
  }
  .corazon:nth-child(2) {
    left: 50%;
    animation-delay: 3.2s;
    width: 28px;
    height: 28px;
    margin-left: -14px;
  }
  .corazon:nth-child(3) {
    left: 85%;
    animation-delay: 5.7s;
  }

  @keyframes corazonFlotar {
    0% {
      top: 110%;
      opacity: 0;
      transform: rotate(45deg) translateY(0);
    }
    50% {
      opacity: 1;
    }
    100% {
      top: -15%;
      opacity: 0;
      transform: rotate(45deg) translateY(-100px);
    }
  }

  /* Scrollbar estilizado */
  #lyrics-container::-webkit-scrollbar {
    width: 8px;
  }
  #lyrics-container::-webkit-scrollbar-thumb {
    background-color: var(--color-boton);
    border-radius: 4px;
  }
  #lyrics-container::-webkit-scrollbar-track {
    background: var(--color-secundario2);
    border-radius: 4px;
  }

  /* Selector de canci√≥n estilo */
  #selector-cancion {
    width: 100%;
    max-width: 480px;
    padding: 12px 18px;
    font-size: 1.1rem;
    border-radius: 25px;
    border: 1.5px solid var(--color-primario);
    margin-bottom: 35px;
    cursor: pointer;
    transition: border-color 0.3s ease;
  }

  #selector-cancion:hover,
  #selector-cancion:focus {
    border-color: var(--color-boton-hover);
    outline: none;
  }

  /* Responsivo */
  @media (max-width: 680px) {
    h1 {
      font-size: 2.2rem;
    }
    .mensaje {
      font-size: 1.1rem;
      max-width: 90vw;
      margin-bottom: 30px;
    }
    #lyrics-container {
      max-height: 220px;
      padding: 20px 25px;
    }
    button.btn-carta {
      padding: 12px 28px;
      font-size: 1.05rem;
    }
    #carta {
      max-width: 90vw;
      font-size: 1rem;
      padding: 25px 20px;
    }
  }
</style>
</head>
<body>
  <main>
    <header>
      <h1 id="titulo-cancion">Nunca te olvid√©</h1>
      <h2 class="mensaje">Te amu Aleydita linda, nunca lo olvides.üíï</h2>
      <h3 id="frase-rotativa" class="mensaje"></h3>
    </header>

    <label for="selector-cancion" class="mensaje" style="font-weight:600;">Elige una canci√≥n:</label>
    <select id="selector-cancion" aria-label="Selector de canci√≥n">
      <option value="morat">Nunca te olvid√© - Morat</option>
      <option value="nuncaestoy">Nunca Estoy - C. Tangana</option>
      <option value="parteme">P√°rteme la cara - C. Tangana</option>
      <option value="comerte">Comerte entera - C. Tangana</option>
    </select>

    <audio id="audio" controls>
      <source id="audio-source" src="Nuncateolvide.mp3, comerteentera.mp3, nuncaestoy.mp3, partemelacara.mp3" type="audio/mp3" />
      Tu navegador no soporta el audio.
    </audio>

    <section id="lyrics-container" tabindex="0" aria-label="Letras de la canci√≥n">
      <ul id="lyrics"></ul>
    </section>

    <button class="btn-carta" aria-expanded="false" aria-controls="carta" title="Leer carta de amor">üíå Leer Carta</button>
    <article id="carta" aria-live="polite" aria-atomic="true"></article>

    <div class="corazones">
      <div class="corazon"></div>
      <div class="corazon"></div>
      <div class="corazon"></div>
    </div>
  </main>

<script>
  // Frases rotativas
  const frases = [
    "Eres mi canci√≥n favorita üé∂",
    "Tu sonrisa es mi hogar üè°",
    "Volver contigo es volver a vivir üåÖ",
    "Contigo, todo tiene sentido ‚ú®"
  ];
  let fraseIndex = 0;
  const fraseEl = document.getElementById("frase-rotativa");
  function cambiarFrase() {
    fraseEl.textContent = frases[fraseIndex];
    fraseIndex = (fraseIndex + 1) % frases.length;
  }
  cambiarFrase();
  setInterval(cambiarFrase, 6000);

  // Variables
  const audio = document.getElementById("audio");
  const audioSource = document.getElementById("audio-source");
  const lyricsEl = document.getElementById("lyrics");
  const lyricsContainer = document.getElementById("lyrics-container");
  const carta = document.getElementById("carta");
  const btnCarta = document.querySelector(".btn-carta");
  const selectorCancion = document.getElementById("selector-cancion");
  const tituloCancion = document.getElementById("titulo-cancion");

  // Carta texto
  const cartaTexto = `Aleydita linda,

Quiero que sepas que no hay un solo d√≠a en que no piense en ti, en esos momentos que compartimos, en tu sonrisa, que es lo mejor de mi d√≠a.

Tener la oportunidad de estar contigo otra vez es algo que agradezco much√≠simo. Eres todo lo que quiero y todo lo que querr√©.

Te amu con todo mi coraz√≥n, y esta vez prometo que nunca m√°s te dejar√©.

Con todo mi amor,
Marquito <3`;

  // Typewriter effect
  function typewriter(text, element, speed = 40) {
    element.textContent = "";
    let i = 0;
    function typing() {
      if (i < text.length) {
        element.textContent += text.charAt(i);
        i++;
        setTimeout(typing, speed);
      }
    }
    typing();
  }

  btnCarta.addEventListener("click", () => {
    const isVisible = carta.classList.contains("visible");
    if (isVisible) {
      carta.classList.remove("visible");
      btnCarta.setAttribute("aria-expanded", "false");
      carta.textContent = "";
    } else {
      carta.classList.add("visible");
      btnCarta.setAttribute("aria-expanded", "true");
      typewriter(cartaTexto, carta, 30);
      carta.scrollIntoView({ behavior: "smooth", block: "center" });
    }
  });

  // Letras y audios para canciones
  const canciones = {
    morat: {
      titulo: "Nunca te olvid√© - MORAT",
      audio: "Nuncateolvide.mp3",
      letras: [
        { time: 1.5, line: "T√∫ lloraste primero" },
      { time: 4, line: "Y aunque llegu√© a arrepentirme, ya era tres meses muy tarde" },
      { time: 12, line: "Pero seamos sinceros" },
      { time: 14, line: "Yo no quer√≠a despedirme y t√∫ no quer√≠as olvidarme" },
      { time: 20, line: "Estoy tan arrepentido, tan arrepentido" },
      { time: 25, line: "Porque fui un cobarde que por orgullo no est√° contigo" },
      { time: 30, line: "Estoy tan arrepentido, tan arrepentido" },
      { time: 35, line: "Yo s√© que a ti ya no te asustan con mi nombre (no)" },
      { time: 40, line: "Y de seguro no escondes un suspiro si me ves" },
      { time: 45, line: "Yo s√© que a ti te est√° fallando la memoria (mmh)" },
      { time: 50, line: "Y a lo peor, nuestra historia ya no cuelga de un 'tal vez'" },
      { time: 55, line: "Pero si todo sale bien, ya no tendr√© m√°s pesadillas (no)" },
      { time: 60, line: "Ni raspadas las rodillas por rogar ante tus pies" },
      { time: 66, line: "Y si te atreves a volver, te acordar√°s sin que te diga" },
      { time: 71, line: "Que nunca te olvid√©" },
      { time: 73, line: "Yo nunca ocultar√© que fue mi error" },
      { time: 75, line: "Porque yo me hice el sordo con tu voz" },
      { time: 77, line: "Y cuando me hizo falta, ya no estaba (no estaba)" },
      { time: 83, line: "Pens√© que no hab√≠a nada que perder (no)" },
      { time: 85, line: "Pero yo estaba ciego en no entender" },
      { time: 88, line: "Que as√≠ perd√≠ el derecho a tu mirada" },
      { time: 91, line: "Estoy tan arrepentido, tan arrepentido" },
      { time: 97, line: "Porque fui un cobarde que por orgullo no est√° contigo" },
      { time: 102, line: "Estoy tan arrepentido, tan arrepentido" },
      { time: 107, line: "Yo s√© que a ti ya no te asustan con mi nombre (no)" },
      { time: 111, line: "Y de seguro no escondes un suspiro si me ves (si me ves)" },
      { time: 117, line: "Yo s√© que a ti te est√° fallando la memoria" },
      { time: 122, line: "Y a lo peor, nuestra historia ya no cuelga de un 'tal vez'" },
      { time: 127, line: "Pero si todo sale bien, ya no tendr√© m√°s pesadillas" },
      { time: 132, line: "Ni raspadas las rodillas por rogar ante tus pies" },
      { time: 137, line: "Y si te atreves a volver (oh), te acordar√°s sin que te diga (ay)" },
      { time: 142, line: "Que nunca te olvid√©" },
      { time: 146, line: "Yo nunca, nunca, nunca te olvid√©" },
      { time: 149, line: "(Woh-oh-oh-oh)" },
      { time: 153, line: "Que nunca te olvid√©" },
      { time: 154, line: "Por ahorrarme un 'te quiero'" },
      { time: 157, line: "No cont√© las cicatrices que iba a costar esperarte (no, oh)" },
      { time: 165, line: "Pero seamos sinceros" },
      { time: 168, line: "Yo no quer√≠a despedirme y t√∫ no quer√≠as olvidarme" },
      { time: 173, line: "Yo s√© que a ti ya no te asustan con mi nombre" },
      { time: 178, line: "Y de seguro no escondes un suspiro si me ves (ya no me ves)" },
      { time: 184, line: "Yo s√© que a ti te est√° fallando la memoria (ah)" },
      { time: 188, line: "Y a lo peor, nuestra historia ya no cuelga de un 'tal vez'" },
      { time: 193, line: "Pero si todo sale bien (todo sale bien), ya no tendr√© m√°s pesadillas (no)" },
      { time: 198, line: "Ni raspadas las rodillas por rogar ante tus pies" },
      { time: 204, line: "Y si te atreves a volver, te acordar√°s sin que te diga (ay)" },
      { time: 208, line: "QUE NUNCA TE OLVID√â <3" }
      ]
    },
    nuncaestoy: {
      titulo: "Nunca estoy - C. Tangana",
      audio: "nuncaestoy.mp3",
      letras: [
  { time: 0, line: "Vamos a repetir esta conversaci√≥n 35 veces" },
  { time: 3, line: "35 veces vamos a hablar de la misma mierda" },
  { time: 5, line: "No me has llama'o" },
  { time: 8, line: "Van dos semanas fuera y ni te has molesta'o" },
  { time: 13, line: "To' lo que s√© de ti es lo que sale en las redes" },
  { time: 17, line: "Escribo tu nombre y otra vez, vas a perder el avi√≥n" },
  { time: 21.5, line: "Y otra vez soy una imb√©cil, esperando a su hombre" },
  { time: 27.5, line: "¬øC√≥mo quieres que te quiera, si no est√°s aqu√≠?" },
  { time: 34, line: "¬øC√≥mo quieres que te quiera, si no est√°s aqu√≠?" },
  { time: 41, line: "¬øC√≥mo quieres que te quiera, si no est√°s aqu√≠?" },
  { time: 48, line: "Dime qu√© quieres hacer, solo sabes correr pa'lante" },
  { time: 51.5, line: "Enga√±arme otra vez, no va a salvarte" },
  { time: 55, line: "Est√°s enfermo de ti, c√°llate, esto no va a ninguna parte" },
  { time: 58.5, line: "Estoy harta de hablar y de esperarte" },
  { time: 65, line: "Y de mirar el m√≥vil hasta tan tarde" },
  { time: 70, line: "¬øC√≥mo quieres que te quiera si no est√°s aqu√≠?" },
  { time: 77, line: "¬øC√≥mo quieres que te quiera si no est√°s aqu√≠?" },
  { time: 83.5, line: "¬øC√≥mo quieres que te quiera si no est√°s aqu√≠?" },
  { time: 89.5, line: "Pienso en con quien est√°s cuando no est√°s conmigo" },
  { time: 94, line: "Odio que mis planes no sean tu camino" },
  { time: 97, line: "Y haberlo negado por estar contigo" },
  { time: 100.5, line: "¬øY qui√©n me va a curar el coraz√≥n partido?" },
  { time: 104, line: "Me dan miedo los meses que se van volando" },
  { time: 108.5, line: "Me he queda'o flaquita de esperarte tanto" },
  { time: 111, line: "¬øC√≥mo quieres que te quiera si no est√°s aqu√≠?" },
  { time: 119, line: "¬øC√≥mo quieres que te quiera si no est√°s aqu√≠?" },
  { time: 126.5, line: "¬øC√ìMO?" }
      ]
    },
    parteme: {
      titulo: "P√°rteme la cara - C. Tangana",
      audio: "partemelacara.mp3",
      letras: [
  { time: 0.5, line: "Mejor dame otra calada" },
  { time: 3.5, line: "O p√°rteme la cara" },
  { time: 6.5, line: "O mi√©nteme y dime que me quieres" },
  { time: 10, line: "Que todo est√° bien, que no ha cambiado nada" },
  { time: 29, line: "Duermo con el caden√≥n bien puesto" },
  { time: 32.7, line: "Porque pienso en las noches que so√±√© su peso" },
  { time: 36.5, line: "Y porque el resto de cosas que importan se fueron contigo" },
  { time: 45, line: "Me he cansa'o del primer puesto" },
  { time: 48, line: "Ya no quiero ser mejor que el resto" },
  { time: 52, line: "Porque todas las cosas que importan se fueron contigo (Ay)" },
  { time: 60.3, line: "Mejor no me digas nada (Ay)" },
  { time: 63.5, line: "Ya no quiero m√°s palabras" },
  { time: 67, line: "Acu√©rdate bien de que me tienes" },
  { time: 70, line: "Cuando quieras, ven, ac√° no pas√≥ nada (Ay)" },
  { time: 75, line: "Mejor dame otra calada (Ay)" },
  { time: 79, line: "O p√°rteme la cara" },
  { time: 82, line: "O mi√©nteme y dime que me quieres" },
  { time: 85, line: "Que todo est√° bien, que no ha cambiado nada" },
  { time: 89.5, line: "Brindo por las noches y lloro en las ma√±anas" },
  { time: 93, line: "Y escribo cosas buenas de algunas chicas malas" },
  { time: 97.5, line: "Sobre todo, cuando ya se han marchado" },
  { time: 105, line: "Guccis en el closet, cien mil en una noche" },
  { time: 108, line: "La vida que quer√≠as, los Lambos y los Porches" },
  { time: 112, line: "Y todo para que al final te hayas marcha'o (Ay)" },
  { time: 120, line: "Mejor no me digas nada (Ay)" },
  { time: 123.5, line: "Ya no quiero m√°s palabras" },
  { time: 126.5, line: "Acu√©rdate bien de que me tienes" },
  { time: 130, line: "Cuando quieras, ven, ac√° no pas√≥ nada (Ay)" },
  { time: 135.5, line: "Mejor dame otra calada (Ay)" },
  { time: 139.5, line: "O p√°rteme la cara" },
  { time: 141.5, line: "O mi√©nteme y dime que me quieres" },
  { time: 144.5, line: "Que todo est√° bien, que no ha cambiado nada" }
]
    },
    comerte: {
      titulo: "Comerte entera - C. Tangana",
      audio: "comerteentera.mp3",
      letras: [
       { time: 2, line: "Tera" },
  { time: 5, line: "Comerte entera" },
  { time: 9, line: "Comerte" },
  { time: 10, line: "No puedo m√°s que pensar" },
  { time: 16, line: "En tu forma de hablar" },
  { time: 21, line: "Roneando" },
  { time: 25, line: "No puedo m√°s que pensar" },
  { time: 32, line: "En tu culo al pasar" },
  { time: 35.5, line: "Rebotando" },
  { time: 39.5, line: "Y en tu forma de atarte el pelo" },
  { time: 43.5, line: "Con una cola, para atr√°s" },
  { time: 47, line: "Quiero agarrarte" },
  { time: 49.3, line: "No aguanto m√°s sin comerte entera" },
  { time: 55, line: "Comerte entera" },
  { time: 58.5, line: "Comerte entera" },
  { time: 63, line: "Comerte entera" },
  { time: 66, line: "(Essa mina √© um perigo)" },
  { time: 71, line: "(√© um perigo)" },
  { time: 74, line: "(Essa mina √© um perigo)" },
  { time: 78, line: "(√© um perigo)" },
  { time: 83, line: "No puedo m√°s que pensar" },
  { time: 89, line: "Quien te saca a bailar" },
  { time: 94, line: "Perreando" },
  { time: 98, line: "No puedo m√°s que pensar" },
  { time: 104, line: "Si √©l te sabe tocar, como yo" },
  { time: 109, line: "Susurrando" },
  { time: 112.5, line: "Y en tu forma de atarte el pelo" },
  { time: 117, line: "Con una cola, para atr√°s" },
  { time: 120.5, line: "Quiero agarrarte, no aguanto m√°s sin comerte entera" },
  { time: 128, line: "Comerte entera" },
  { time: 132, line: "Comerte entera" },
  { time: 136, line: "Comerte entera" },
  { time: 140, line: "(Essa mina √© um perigo)" },
  { time: 143.5, line: "(√© um perigo)" },
  { time: 147, line: "(Essa mina √© um perigo)" },
  { time: 152, line: "(√© um perigo)" },
  { time: 158, line: "No puedo m√°s que pensar" },
  { time: 164, line: "En tu forma de hablar" }
      ]
    }
  };

  // Funci√≥n para actualizar letras activas
  let currentActive = -1;
  function actualizarLetra() {
    const currentTime = audio.currentTime;
    const lines = canciones[currentSong].letras;

    // Buscar la √∫ltima l√≠nea que corresponde al tiempo actual
    let newActive = -1;
    for (let i = 0; i < lines.length; i++) {
      if (currentTime >= lines[i].time) newActive = i;
      else break;
    }
    if (newActive !== currentActive) {
      // Cambiar clase active
      if (currentActive >= 0) lyricsEl.children[currentActive]?.classList.remove("active");
      if (newActive >= 0) lyricsEl.children[newActive]?.classList.add("active");

      // Scroll autom√°tico para que la l√≠nea activa quede visible y centrada
      if (newActive >= 0) {
        const activeLine = lyricsEl.children[newActive];
        const containerHeight = lyricsContainer.clientHeight;
        const lineOffsetTop = activeLine.offsetTop;
        const lineHeight = activeLine.clientHeight;
        const scrollPosition = lineOffsetTop - containerHeight / 2 + lineHeight / 2;
        lyricsContainer.scrollTo({ top: scrollPosition, behavior: "smooth" });
      }

      currentActive = newActive;
    }
  }

  // Actualizar canci√≥n
  let currentSong = "morat";

  function cargarCancion(nombre) {
    currentSong = nombre;
    const cancion = canciones[nombre];
    tituloCancion.textContent = cancion.titulo;
    audioSource.src = cancion.audio;
    audio.load();
    // Cargar letras
    lyricsEl.innerHTML = "";
    cancion.letras.forEach(({ line }, index) => {
      const li = document.createElement("li");
      li.textContent = line;
      lyricsEl.appendChild(li);
    });
    currentActive = -1;
    // Reseteamos scroll
    lyricsContainer.scrollTop = 0;
  }

  // Cambiar canci√≥n desde selector
  selectorCancion.addEventListener("change", (e) => {
    cargarCancion(e.target.value);
  });

  audio.addEventListener("timeupdate", actualizarLetra);

  // Cargar por defecto
  cargarCancion(currentSong);
</script>
</body>
</html>
